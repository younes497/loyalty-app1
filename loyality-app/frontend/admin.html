<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Panel</title>
</head>
<body>
<h1>Admin Panel</h1>
<div id="users"></div>

<script>
const backendURL = "https://loyalty-app1.onrender.com"; // <-- Your Render backend URL

async function loadUsers() {
  try {
    const res = await fetch(`$https://loyalty-app1.onrender.com/api/users`);
    const users = await res.json();
    const container = document.getElementById('users');
    container.innerHTML = '';

    if(users.length === 0) {
      container.innerHTML = "<p>No users yet.</p>";
      return;
    }

    users.forEach(u => {
      const div = document.createElement('div');
      div.style.marginBottom = "10px";
      div.innerHTML = `
        <strong>${u.name}</strong> - ${u.email} - Active: ${u.subscriptionActive} - Points: ${u.points}
        <button onclick="activate('${u._id}')">Activate</button>
        <button onclick="addPoints('${u._id}')">+10 Points</button>
      `;
      container.appendChild(div);
    });
  } catch(err) {
    document.getElementById('users').innerHTML = "<p>Error loading users.</p>";
    console.error(err);
  }
}

async function activate(id) {
  await fetch(`$https://loyalty-app1.onrender.com/api/users/${id}/activate`, { method: 'POST' });
  loadUsers();
}

async function addPoints(id) {
  await fetch(`$https://loyalty-app1.onrender.com/api/users/${id}/addpoints`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ points: 10 })
  });
  loadUsers();
}

// Load users on page load
loadUsers();
</script>
</body>
</html>
